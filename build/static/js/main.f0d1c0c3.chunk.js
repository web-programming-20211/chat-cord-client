(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{227:function(e,t,n){},229:function(e,t,n){},331:function(e,t,n){},334:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(19),a=n.n(r),s=(n(227),n(9)),c=n(37),l=n(5),d=n(21),u=n.n(d),p=(n(229),n(211)),j=n(34),b=n.n(j),f=n(57),x=n.n(f),m=n(66),h=n(378),g=n(384),v=n(393),O=(n(252),n(210)),y=n(143),w=n.n(y);n(336);w.a.initializeApp({apiKey:"AIzaSyCBJRfaIq-9QJMSreqGgbYErDHLbhv1naU",authDomain:"chat-cord-712bf.firebaseapp.com",projectId:"chat-cord-712bf",storageBucket:"chat-cord-712bf.appspot.com",messagingSenderId:"196707948525",appId:"1:196707948525:web:c2690d98f36a957b0479e4",measurementId:"G-WXRTH429VW"});var C=w.a.storage(),k=n(41),I=n(2),S=function(e){var t=e.setDialogs,n=Object(i.useState)(""),o=Object(l.a)(n,2),r=o[0],a=o[1],c=Object(i.useState)(!1),d=Object(l.a)(c,2),u=d[0],p=d[1],j=Object(i.useState)([]),b=Object(l.a)(j,2),f=b[0],x=b[1],y=Object(i.useState)([]),w=Object(l.a)(y,2),S=(w[0],w[1]),R=Object(i.useState)([{id:null,url:null,name:null,fileUrl:null}]),D=Object(l.a)(R,2),F=D[0],M=D[1],z=Object(m.useMediaQuery)({maxWidth:900}),E={input:{display:"block",position:"relative",left:"10px",top:"20px",width:"108%"},textField:{width:Object(m.useMediaQuery)({maxWidth:600})?"60%":z?"70%":"90%",fontSize:"x-large",outline:"none",paddingLeft:"20px",paddingBottom:"10px",paddingTop:"10px",marginLeft:"30px",backgroundColor:"transparent",color:"#FDFDFD"},send:{position:"absolute",right:10,cursor:"pointer",color:"#6082B6",fontSize:"30px"},attach:{position:"absolute",right:100,cursor:"pointer"},image:{position:"absolute",right:50,cursor:"pointer"},icons:{fontSize:"30px",position:"absolute",left:-45,color:"#6082B6",cursor:"pointer"},file:{color:"#6082B6",fontSize:"30px",position:"absolute",cursor:"pointer",right:45,bottom:14},fileImage:{color:"#6082B6",fontSize:"30px",position:"absolute",cursor:"pointer",right:50,bottom:14},preview:{zIndex:1,position:"absolute",width:"100%",height:"200px",right:"1px",bottom:"60px",background:"#6588DE",boxShadow:"0px 8px 40px rgba(0, 72, 251, 0.3)",borderRadius:"14px",padding:"20px",display:"flex",alignItems:"center"},thumbnail:{width:"100px",height:"100px",borderRadius:"10px"},deletePreviewIcon:{color:"red",fontSize:"20px",cursor:"pointer",position:"relative",top:"-56px"},fileName:{position:"relative",left:"50px",top:"5px",color:"white"},addFile:{display:"grid",placeItems:"center",position:"relative",bottom:18,left:18,width:"100px",height:"100px",borderRadius:"10px",border:"1px dashed #F9FBFB",boxSizing:"border-box"},addIcon:{fontSize:"50px",color:"#F9FBFB"}},_=function(){if(r.length>0||f.length>0){var e=[];f.map((function(t){var n=new Promise((function(e,n){var i={contentType:t.type};C.ref("files/".concat(t.name)).put(t,i).then((function(t){t.ref.getDownloadURL().then((function(t){e(t)}))}))}));e.push(n)})),Promise.all(e).then((function(e){S((function(t){return[].concat(Object(s.a)(t),[e])})),t(r,e)}))}M([]),x([])},B=function(){if(F)return Object(I.jsxs)("div",{style:E.preview,children:[F.map((function(e){return Object(I.jsxs)("div",{children:[Object(I.jsx)(k.a,{onClick:function(){return t=e.id,M(F.filter((function(e){return e.id!==t}))),void x(f.filter((function(e){return e.id!==t})));var t},style:E.deletePreviewIcon,icon:"ep:circle-close"}),Object(I.jsx)("img",{style:E.thumbnail,src:e.fileUrl?e.fileUrl:e.url,alt:"thumb"}),Object(I.jsx)("p",{style:E.fileName,children:e.name})]},e.id)})),Object(I.jsx)("div",{style:E.addFile,children:Object(I.jsx)("label",{htmlFor:"files",children:Object(I.jsx)(k.a,{style:E.addIcon,icon:"carbon:add-alt"})})})]})};return Object(I.jsx)("div",{style:E.input,children:Object(I.jsx)(h.a,{fullWidth:!0,sx:{m:1},children:Object(I.jsx)(g.a,{style:E.textField,value:r,onKeyUp:function(e){"Enter"===e.key&&(_(),a(""))},id:"outlined-basic",variant:"outlined",placeholder:"Type a new message...",onChange:function(e){return a(e.target.value)},autoComplete:"off",InputProps:{endAdornment:Object(I.jsxs)(v.a,{position:"end",children:[Object(I.jsx)(k.a,{onClick:function(){_(),a("")},style:E.send,icon:"akar-icons:send"}),Object(I.jsx)(k.a,{icon:"fluent:emoji-24-regular",style:E.icons,onClick:function(){p(!u)}}),Object(I.jsx)("label",{htmlFor:"files",children:Object(I.jsx)(k.a,{style:E.fileImage,icon:"akar-icons:image"})}),Object(I.jsx)("input",{id:"files",style:{visibility:"hidden"},type:"file",multiple:!0,onChange:function(e){for(var t=function(t){var n=e.target.files[t];console.log("newFile",n.type),n.id=Math.random();var i="",o="";"image"!==n.type.split("/")[0]?(i="file.png",o="file ".concat(t+1)):(i=null,o="image ".concat(t+1));var r=new FileReader;r.readAsDataURL(n),r.onloadend=function(){M((function(e){return[].concat(Object(s.a)(e),[{id:n.id,url:r.result,name:o,fileUrl:i}])}))},x((function(e){return[].concat(Object(s.a)(e),[n])}))},n=0;n<e.target.files.length;n++)t(n)}}),f.length>0&&Object(I.jsx)(B,{}),u&&Object(I.jsx)("div",{style:{position:"fixed",bottom:"80px",left:"20%",zIndex:"1"},children:Object(I.jsx)(O.a,{onSelect:function(e){a((function(t){return t+e.native}))},emojiSize:20})})]})}})})})},R=n(4),D=n(203),F=n.n(D),M=function(e){var t=e.dialog,n=e.react,o=e.self,r=Object(i.useState)(!1),a=Object(l.a)(r,2),s=a[0],c=a[1],d={emoji:{borderRadius:"50%",padding:"1px",cursor:"pointer",transition:"background 300ms ease-out"},emojiList:{display:"flex",position:"absolute",top:-16,right:o?2:"none",flexDirection:o?"row-reverse":"row"},allEmoji:{position:"relative"}},u=function(e){n(e,t._id)};return Object(I.jsxs)("div",{style:d.allEmoji,onMouseLeave:function(){return c(!1)},children:[s&&Object(I.jsxs)("div",{style:d.emojiList,children:[Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(1)},children:"\u2764\ufe0f"}),Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(2)},children:"\ud83d\ude02"}),Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(3)},children:"\ud83d\ude2e"}),Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(4)},children:"\ud83d\ude22"}),Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(5)},children:"\ud83d\ude20"}),Object(I.jsx)("div",{style:{fontSize:"15px",cursor:"pointer"},onClick:function(){return u(6)},children:"\ud83d\udc4d"})]}),Object(I.jsx)(F.a,{style:d.emoji,onClick:function(){c(!s)}})]})},z=function(e){var t=e.emojiIndex,n={marginRight:"2px",cursor:"pointer",fontSize:"small"},i=function(){switch(t){case 1:return Object(I.jsx)("div",{style:n,children:"\u2764\ufe0f"});case 2:return Object(I.jsx)("div",{style:n,children:"\ud83d\ude02"});case 3:return Object(I.jsx)("div",{style:n,children:"\ud83d\ude2e"});case 4:return Object(I.jsx)("div",{style:n,children:"\ud83d\ude22"});case 5:return Object(I.jsx)("div",{style:n,children:"\ud83d\ude20"});case 6:return Object(I.jsx)("div",{style:n,children:"\ud83d\udc4d"})}};return Object(I.jsx)(i,{})},E=n(206),_=n.n(E),B=n(205),L=n.n(B),P=n(117),A=n.n(P),T=n(389),W=function(e){var t=e.reactions,n=e.self,i={icons:{display:"flex",position:"absolute",right:n&&0,left:!n&&0,bottom:-9,borderRadius:"25px",backgroundColor:"#aaa",paddingLeft:5,paddingRight:5}};return Object(I.jsx)("div",{style:i.iconsInfo,children:Object(I.jsx)("div",{style:i.icons,children:t.map((function(e){return 0!==e.from.length?Object(I.jsx)(z,{emojiIndex:e.reaction_type},e.reaction_type):null}))})})},U=function(e){var t=e.dialog,n=e.onDelete,o=e.room,r=e.socket,a=Object(i.useState)(!1),c=Object(l.a)(a,2),d=c[0],u=c[1],p=Object(i.useState)(!1),j=Object(l.a)(p,2),f=(j[0],j[1],Object(i.useState)([])),m=Object(l.a)(f,2),h=m[0],g=m[1],v=Object(i.useState)(null),O=Object(l.a)(v,2),y=O[0],w=O[1],C=Object(i.useState)(!1),k=Object(l.a)(C,2),S=k[0],D=k[1],F=Object(i.useState)(null),z=Object(l.a)(F,2),E=z[0],B=z[1],P=Object(i.useState)(0),U=Object(l.a)(P,2),N=U[0],q=U[1],H={dialogDiv:{width:"95%",position:"relative",display:"flex",flexDirection:y?"row-reverse":"row",marginLeft:"20px",marginRight:"20px",alignItems:"flex-start",padding:"0px",marginBottom:"30px"},bubble:{backgroundColor:y?"#32a6b8":"#c27f67",color:"#ffffff",padding:"5px 10px",margin:"0px",borderRadius:"25px",maxWidth:"100%",position:"relative"},avatar:{position:"relative",marginTop:"15px",background:"#".concat(t.from.color),flexShrink:0},widget:Object(R.a)({flexShrink:0,opacity:d?1:0,transition:"opacity 250ms",display:"flex",flexDirection:y?"row-reverse":"flex"},"flexShrink",0),widgetItem:{cursor:"pointer",borderRadius:"50%"},deleteIcon:{borderRadius:"50%",padding:"1px",cursor:"pointer"},pinIcon:{borderRadius:"50%",padding:"1px",cursor:"pointer"},container:{display:"flex",flexDirection:"column",alignItems:y?"flex-end":"flex-start",rowGap:"1em",padding:"10px",borderRadius:"14px"},reply:{display:"block"},dialogDivInfoNameTime:{display:"flex",flexDirection:y?"row-reverse":"flex",alignItems:"baseline",width:"100%",marginBottom:"-10px"},dialogDivInfoName:{fontFamily:"Poppins",color:"#52585D",fontSize:"20px",fontWeight:"600",marginLeft:y?"10px":"0px"},dialogDivInfoTime:{fontFamily:"Poppins",opacity:S?1:0,transition:"opacity 250ms",color:"#52585D",fontSize:"16px",marginLeft:y?"0px":"10px"},dialogDivInfoMessageWidget:{display:"flex",flexDirection:y?"row-reverse":"flex"},dialogDivInfoMessage:{position:"relative",display:"flex",flexDirection:"column",alignItems:y?"flex-end":"flex-start",margin:"0xp"},dialogDivInfoFiles:{display:"grid",gridTemplateColumns:1===N?"repeat(1, 1fr)":2==N?"repeat(2, 1fr)":"repeat(3, 1fr)",gap:"10px"},des:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",width:"150px",workBreak:"break-word"}};return Object(i.useEffect)((function(){if(r.on("return-reaction",(function(e){t._id===e._id&&g(e.data)})),null===y){var e=x.a.get("userId"),n=e.indexOf('"');w(e.slice(n+1,e.length-1)===t.from.userId),e.slice(n+1,e.length-1)===o.creator&&B(!0)}return function(){r.off("return-reaction")}}),[t]),Object(i.useEffect)((function(){b.a.post("/reaction/retrieve",{id:t._id},{withCredentials:!0}).then((function(e){g(e.data.data)}))}),[]),Object(i.useEffect)((function(){q(t.urls.length)}),[]),Object(I.jsxs)("div",{style:H.dialogDiv,onMouseEnter:function(){return D(!0)},onMouseLeave:function(){return D(!1)},children:[!y&&Object(I.jsx)(T.a,{size:60,style:H.avatar,src:t.from.avatar}),y&&Object(I.jsx)(T.a,{size:60,style:H.avatar,src:t.from.avatar}),Object(I.jsxs)("div",{style:H.container,onMouseEnter:function(){return u(!0)},onMouseLeave:function(){return u(!1)},children:[y&&Object(I.jsxs)("div",{style:H.dialogDivInfoNameTime,children:[Object(I.jsx)("div",{style:H.dialogDivInfoName,children:t.from.username}),Object(I.jsx)("div",{style:H.dialogDivInfoTime,children:A()(t.createdAt).calendar()})]}),!y&&Object(I.jsxs)("div",{style:H.dialogDivInfoNameTime,children:[Object(I.jsx)("div",{style:H.dialogDivInfoName,children:t.from.username}),Object(I.jsx)("div",{style:H.dialogDivInfoTime,children:A()(t.createdAt).calendar()})]}),Object(I.jsxs)("div",{style:H.dialogDivInfoMessageWidget,children:[Object(I.jsxs)("div",{style:H.dialogDivInfoMessage,children:[t.content&&Object(I.jsx)("p",{style:H.bubble,children:t.content}),Object(I.jsx)(W,{reactions:h,self:y}),Object(I.jsx)("div",{style:H.dialogDivInfoFiles,children:t.urls.length>0&&t.urls.map((function(e,t){var n=e.split(".").pop().split("?")[0];return"mp4"===n?Object(I.jsx)("video",{onClick:function(e){e.target.classList.toggle("zoom")},style:{width:"500px",marginBottom:"10px",transition:"1s"},controls:!0,children:Object(I.jsx)("source",{src:e,type:"video/mp4"})},t):"pdf"===n?Object(I.jsxs)("a",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},href:e,target:"_blank",rel:"noopener noreferrer",children:[Object(I.jsx)("img",{src:"pdf_file_icon.png",style:{width:"50px",marginBottom:"10px",marginRight:"10px"}}),Object(I.jsx)("p",{style:H.des,children:e.split("%2F").pop().split("?")[0]})]},t):"docx"===n||"doc"===n?Object(I.jsxs)("a",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},href:e,target:"_blank",rel:"noopener noreferrer",children:[Object(I.jsx)("img",{src:"docx_file_icon.png",style:{width:"50px",marginBottom:"10px",marginRight:"10px"}}),Object(I.jsx)("p",{style:H.des,children:e.split("%2F").pop().split("?")[0]})]},t):"jpg"===n||"png"===n||"jpeg"===n?Object(I.jsx)("img",{onClick:function(e){e.target.classList.toggle("zoom")},src:e,style:{width:"100%",height:"150px",objectFit:"cover",marginBottom:"10px",transition:"1s"}},t):void 0}))})]}),Object(I.jsxs)("div",{style:H.widget,children:[Object(I.jsx)(M,{dialog:t,react:function(e,n){var i=x.a.get("userId"),a=i.indexOf('"'),c=i.slice(a+1,i.length-1),l=Object(s.a)(h),d=0;if(l.every((function(e){var t=e.from.findIndex((function(e){return e.userId===c}));return-1===t||(e.from.splice(t,1),d=e.reaction_type,!1)})),d!==e){var u=l.findIndex((function(t){return t.reaction_type===e}));-1!==u?l[u].from.push({userId:c,username:" "}):l.push({reaction_type:e,from:[{userId:c,username:" "}]})}g(Object(s.a)(l)),r.emit("get-reaction",t,e,c,o._id)},self:y}),Object(I.jsx)(L.a,{style:H.pinIcon,onClick:function(){r.emit("set-pin",t,o._id)}}),(y||E)&&Object(I.jsx)(_.a,{style:H.deleteIcon,onClick:function(){return n(t,o.creator)}})]})]})]})]})},N=function(e){var t=e.socket,n=e.room,o=e.dialogs,r=e.deleteMessage,a=Object(i.useRef)(null);return Object(i.useEffect)((function(){a.current.scrollIntoView({behavior:"smooth"})}),[o]),Object(I.jsxs)("div",{style:{display:"block",width:"100%",height:"77vh",overflow:"auto",margin:"10px 0px 0px 10px"},children:[o.map((function(e){return Object(I.jsx)(U,{socket:t,dialog:e,onDelete:r,room:n},e._id)})),Object(I.jsx)("div",{ref:a})]})},q=n(8),H=n(3),V=n(385),G=n(390),K=n(387),Q=n(391),J=n(394),$=n(386),Y=n(395),Z=n(92),X=n(207),ee=n.n(X),te=n(42),ne=["key","name","fieldKey"],ie=V.a.TabPane,oe=function(e){var t,n,o,r,a,s,d=e.userOnlines,p=e.room,j=e.dialogs,f=e.leave,m=e.socket,h=Object(i.useState)([]),g=Object(l.a)(h,2),v=g[0],O=g[1],y=Object(i.useState)(p),w=Object(l.a)(y,2),S=(w[0],w[1]),R=Object(i.useState)(!1),D=Object(l.a)(R,2),F=D[0],M=D[1],z=Object(i.useState)(!1),E=Object(l.a)(z,2),_=E[0],B=E[1],L=Object(i.useState)(!1),P=Object(l.a)(L,2),A=P[0],W=P[1],U=Object(i.useState)(!1),N=Object(l.a)(U,2),X=N[0],oe=N[1],re=[],ae=Object(i.useState)(null),se=Object(l.a)(ae,2),ce=se[0],le=se[1],de=Object(i.useState)(),ue=Object(l.a)(de,2),pe=ue[0],je=ue[1],be=x.a.get("userId").slice(x.a.get("userId").indexOf('"')+1,x.a.get("userId").length-1),fe=Object(i.useState)({name:"",description:"",isPrivate:p.isPrivate,avatar:""}),xe=Object(l.a)(fe,2),me=xe[0],he=xe[1],ge=Object(i.useState)(p.isPrivate),ve=Object(l.a)(ge,2),Oe=ve[0],ye=ve[1],we=function(){M(!1)},Ce=function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,i,o,r,a,s,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=me,!pe){e.next=11;break}return n={contentType:pe.type},i=C.ref("roomAvatars/".concat(pe.name)),e.next=6,i.put(pe,n);case 6:return o=e.sent,e.next=9,o.ref.getDownloadURL();case 9:r=e.sent,t.avatar=r;case 11:return e.prev=11,console.log(t),e.next=15,b.a.put("/room/".concat(p._id),t,{withCredentials:!0});case 15:s=e.sent,te.a.success(null===s||void 0===s||null===(a=s.data)||void 0===a?void 0:a.msg),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(11),te.a.error("".concat(null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c||null===(l=c.data)||void 0===l?void 0:l.msg));case 22:le(me.avatar),je(null),B(!1);case 25:case"end":return e.stop()}}),e,null,[[11,19]])})));return function(){return e.apply(this,arguments)}}(),ke={chatHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"50px",backgroundColor:"#6588DE",height:"20px",width:"100%",margin:"0px 0px 0px 10px",position:"relative"},pinMessageContainer:{position:"absolute",backgroundColor:"#E3F6FC",bottom:"-67px",left:"0px",zIndex:"1",width:"100%",display:"flex",alignItems:"center",gap:"10px"},pinMessageIcon:{},chatInfo:{margin:"5px",display:"flex",flexDirection:"column",alignItems:"flex-start",cursor:"pointer"},chatName:{margin:"0px",fontSize:"20px",fontWeight:"bold",color:"#FDFDFE"},numberOfUser:{margin:"0px",fontSize:"14px",color:"#F2F6F7"},chatTool:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},tuneIcon:{cursor:"pointer",fontSize:"20px"},roomInfo:{display:"flex",flexDirection:"column",alignItems:"center"},roomTitle:{marginBottom:"30px",fontWeight:600,fontSize:"18px",lineHeight:"27px",color:"#6588DE"},roomAvatar:{marginBottom:"20px",border:"4px solid #"+p.color,borderRadius:"115px"},roomName:{marginBottom:"6px",fontWeight:600,fontSize:"16px",lineHeight:"24px",color:"#6588DE"},roomDescription:{marginBottom:"20px",fontSize:"12px",lineHeight:"150.5%",color:"#52585D"},roomShortId:{cursor:"pointer",fontSize:"20px",marginBottom:"30px"},line:{width:"280px",height:"0px",borderBottom:"1px solid #D0D9DF",marginBottom:"20px"},media:{height:"400px",overflowY:"auto",display:"block"},mediaGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",maxWidth:"100%"},file:{display:"flex",height:"400px",flexDirection:"column",alignItems:"flex-start"},members:{display:"flex",height:"400px",flexDirection:"column",alignItems:"flex-start",gap:"10px",overflowY:"auto"},member:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:"10px"},leaveRoom:{display:"flex",flexDirection:"row",cursor:"pointer",fontSize:"20px",borderRadius:"8px",alignItems:"center",gap:"11px",border:"1px solid #6588DE",height:"39px"},leaveRoomIcon:{color:"#6588DE",with:"18px",height:"20px",marginLeft:"14px"},leaveRoomText:{margin:"0px",with:"72px",fontWeight:500,fontSize:"12px",lineHeight:"18px",color:"#6588DE"},avatar:{position:"relative"},dot:{position:"absolute",bottom:"6px",right:"3px",height:"8px",width:"8px",borderRadius:"50%",backgroundColor:"#46D362"},des:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",width:"320px",workBreak:"break-word"},infoIcon:{position:"relative",top:"5px"},buttonEditDrawer:{border:"none",backgroundColor:"#E3F6FC",color:"#6588DE",cursor:"pointer"},buttonUpdateDrawer:{position:"relative",left:"50%",marginRight:"5px"},roomAvatarEdit:{width:"fit-content",display:"block",margin:"auto",border:"4px solid #"+p.color,borderRadius:"115px",cursor:"pointer"},plusIconContainer:{width:55,height:55,borderRadius:"50%",border:"1px dashed #6ECB63",display:"grid",placeItems:"center",backgroundColor:"rgb(227, 246, 252)"},plusIcon:{fontSize:"20px"},removeIcon:{fontSize:"18px",color:"#E74C3C"},submitButton:{borderRadius:"5px"}},Ie=G.a.Option,Se=Object(I.jsxs)(G.a,{defaultValue:"Message",children:[Object(I.jsx)(Ie,{value:"Message",children:"Message"}),Object(I.jsx)(Ie,{value:"User",children:"User"})]});Object(i.useEffect)((function(){var e;S(p),-1!==(null===p||void 0===p?void 0:p._id)&&b.a.get("/room/"+(null===p||void 0===p?void 0:p._id)+"/members",{withCredentials:!0}).then((function(e){O(e.data.msg)})),(null===p||void 0===p||null===(e=p.pinnedMessages)||void 0===e?void 0:e.length)>0&&oe(!0)}),[p]),Object(i.useEffect)((function(){m.on("new-pinned-message",(function(e,t,n){t===p._id&&(0===n.pinnedMessages.length?oe(!1):(oe(!0),W(n.pinnedMessages.at(-1))))}))}),[p]);var Re=function(){var e=Object(c.a)(u.a.mark((function e(t){var n,i,o,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(re=[],n=0;n<t.usersList.length;n++)re.push(t.usersList[n].first);return e.prev=2,e.next=5,b.a.post("/room/"+(null===p||void 0===p?void 0:p._id)+"/add",{emails:re.join(",")},{withCredentials:!0});case 5:i=e.sent,te.a.success(i.data.msg),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),te.a.error("".concat(null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.msg));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)("div",{style:ke.chatHeader,children:[Object(I.jsxs)("div",{style:ke.chatInfo,onClick:function(){M(!0)},children:[Object(I.jsxs)("p",{style:ke.chatName,children:[null===p||void 0===p?void 0:p.name," ",Object(I.jsx)(k.a,{style:ke.infoIcon,icon:"ant-design:info-circle-outlined"})]}),Object(I.jsx)("p",{style:ke.numberOfUser,children:(null===v||void 0===v?void 0:v.length)+" members"})]}),Object(I.jsx)("div",{style:ke.chatTool,children:Object(I.jsx)(K.a,{style:ke.input,autoComplete:"off",addonBefore:Se,placeholder:"Type user or a message you what to search..."})}),Object(I.jsxs)(Q.a,{placement:"right",onClose:we,visible:F,extra:Object(I.jsx)(J.b,{children:Object(I.jsx)("button",{onClick:function(){B(!_)},style:ke.buttonEditDrawer,children:"Edit"})}),children:[Object(I.jsxs)("div",{style:ke.roomInfo,children:[Object(I.jsx)("div",{style:ke.roomTitle,children:"Room Info"}),!_&&Object(I.jsx)("div",{style:ke.roomAvatar,children:Object(I.jsx)(T.a,{size:200,src:p.avatar})}),_&&Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{style:ke.roomAvatarEdit,htmlFor:"roomAvatar",children:Object(I.jsx)(T.a,{size:200,src:ce||p.avatar})}),Object(I.jsx)("input",{id:"roomAvatar",style:{visibility:"hidden"},accept:"image",type:"file",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){le(n.result)},je(t)}})]}),!p.isPrivate&&Object(I.jsx)("div",{style:ke.roomShortId,onClick:function(){ee()(null===p||void 0===p?void 0:p.shortId),te.a.success("Copied to clipboard")},children:null===p||void 0===p?void 0:p.shortId}),Object(I.jsx)("div",{style:ke.roomName,children:null===p||void 0===p?void 0:p.name}),Object(I.jsx)("div",{style:ke.roomDescription,children:null===p||void 0===p?void 0:p.description}),Object(I.jsx)("div",{style:ke.line})]}),_?Object(I.jsxs)($.a,{labelCol:{span:10},wrapperCol:{span:20},onFinish:Ce,children:[Object(I.jsx)($.a.Item,{label:"Room name",rules:[{required:!0,message:"Please input room name!"}],children:Object(I.jsx)(K.a,{defaultValue:p.name,onChange:function(e){return he(Object(H.a)(Object(H.a)({},me),{},{name:e.target.value}))}})}),Object(I.jsx)($.a.Item,{label:"Description",rules:[{required:!0,message:"Please input room description!"}],children:Object(I.jsx)(K.a,{defaultValue:p.description,onChange:function(e){return he(Object(H.a)(Object(H.a)({},me),{},{description:e.target.value}))}})}),be==p.creator&&Object(I.jsx)($.a.Item,{label:"Mode",children:Object(I.jsx)(Y.a,{defaultChecked:Oe,checkedChildren:"Private",unCheckedChildren:"Public",onClick:function(e){ye((function(e){return!e})),he((function(e){return Object(H.a)(Object(H.a)({},e),{},{isPrivate:!e.isPrivate})}))}})}),Object(I.jsx)($.a.Item,{wrapperCol:{offset:10,span:16},children:Object(I.jsx)(Z.a,{type:"primary",htmlType:"submit",children:"Save"})})]}):Object(I.jsxs)(V.a,{style:{marginBottom:"25px"},defaultActiveKey:"1",children:[Object(I.jsx)(ie,{tab:"Images",children:Object(I.jsx)("div",{style:ke.media,children:Object(I.jsx)("div",{style:ke.mediaGrid,children:j.map((function(e){return e.urls.length>0&&e.urls.map((function(e,t){var n=e.split(".").pop().split("?")[0];if("jpg"===n||"png"===n||"jpeg"===n)return Object(I.jsx)("img",{src:e,onClick:function(e){e.target.classList.toggle("zoom")},style:{width:"100%",height:"100px",objectFit:"cover",marginBottom:"10px",transition:"1s"}})}))}))})})},"1"),Object(I.jsx)(ie,{tab:"Videos",children:Object(I.jsx)("div",{style:ke.media,children:Object(I.jsx)("div",{style:ke.mediaGrid,children:j.map((function(e){return e.urls.length>0&&e.urls.map((function(e,t){if("mp4"===e.split(".").pop().split("?")[0])return Object(I.jsx)("video",{onClick:function(e){e.target.classList.toggle("zoom")},style:{width:"100%",height:"100px",objectFit:"cover",marginBottom:"10px",transition:"1s"},controls:!0,children:Object(I.jsx)("source",{src:e,type:"video/mp4"})},t)}))}))})})},"2"),Object(I.jsx)(ie,{tab:"Files",children:Object(I.jsx)("div",{style:ke.file,children:j.map((function(e){return e.urls.length>0&&e.urls.map((function(e,t){var n=e.split(".").pop().split("?")[0];return"pdf"===n||"docx"===n?Object(I.jsx)("a",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},href:e,target:"_blank",rel:"noopener noreferrer",children:Object(I.jsx)("p",{style:ke.des,children:e.split("%2F").pop().split("?")[0]})},t):void 0}))}))})},"3"),Object(I.jsx)(ie,{tab:"Members",children:Object(I.jsxs)("div",{style:ke.members,children:[(be==p.creator&&p.isPrivate||!p.isPrivate)&&Object(I.jsxs)($.a,{name:"add user dynamic form",autoComplete:"off",onFinish:Re,children:[Object(I.jsx)($.a.List,{name:"usersList",children:function(e,t){var n=t.add,i=t.remove;return Object(I.jsxs)(I.Fragment,{children:[e.map((function(e){var t=e.key,n=e.name,o=e.fieldKey,r=Object(q.a)(e,ne);return Object(I.jsxs)(J.b,{style:{display:"flex",marginBottom:2},align:"baseline",children:[Object(I.jsx)($.a.Item,Object(H.a)(Object(H.a)({},r),{},{name:[n,"first"],fieldKey:[o,"first"],rules:[{type:"email",required:!0,message:"Email is required!"}],children:Object(I.jsx)(K.a,{placeholder:"Email"})})),Object(I.jsx)(k.a,{style:ke.removeIcon,icon:"gg:remove",onClick:function(){return i(n)}})]},t)})),Object(I.jsx)($.a.Item,{children:Object(I.jsx)(Z.a,{onClick:function(){return n()},block:!0,style:ke.plusIconContainer,children:Object(I.jsx)(k.a,{style:ke.plusIcon,icon:"carbon:add"})})})]})}}),Object(I.jsx)($.a.Item,{children:Object(I.jsx)(Z.a,{style:ke.submitButton,type:"primary",htmlType:"submit",children:"Submit"})})]}),null===v||void 0===v?void 0:v.map((function(e,t){return Object(I.jsxs)("div",{style:ke.member,children:[Object(I.jsxs)("div",{style:ke.avatar,children:[Object(I.jsx)(T.a,{style:{backgroundColor:"#"+(null===e||void 0===e?void 0:e.color)},size:50,src:null===e||void 0===e?void 0:e.avatar}),d.includes(null===e||void 0===e?void 0:e._id)&&Object(I.jsx)("span",{style:ke.dot})]}),Object(I.jsx)("p",{style:{fontSize:"16px"},children:null===e||void 0===e?void 0:e.fullname})]},t)}))]})},"4")]}),!_&&Object(I.jsxs)("div",{style:ke.leaveRoom,children:[Object(I.jsx)(k.a,{style:ke.leaveRoomIcon,icon:"pepicons:leave"}),Object(I.jsx)("p",{style:ke.leaveRoomText,onClick:function(){we(),f(p._id)},children:"Leave Room"})]})]}),X&&Object(I.jsxs)("div",{style:ke.pinMessageContainer,children:[Object(I.jsx)(k.a,{style:ke.pinMessageIcon,icon:"bi:pin-angle-fill"}),Object(I.jsxs)("div",{style:ke.pinMessageInfo,children:[Object(I.jsx)("div",{style:ke.pinMessageTitle,children:"Pinned message"}),Object(I.jsxs)("div",{style:ke.pinMessageContent,children:[Object(I.jsx)(T.a,{style:ke.pinMessageAvatar,src:A?null===A||void 0===A?void 0:A.avatar:null===p||void 0===p||null===(t=p.pinnedMessages)||void 0===t||null===(n=t.at(-1))||void 0===n?void 0:n.avatar}),Object(I.jsxs)("div",{children:[Object(I.jsx)("p",{style:ke.pinMessageName,children:A?null===A||void 0===A?void 0:A.username:null===p||void 0===p||null===(o=p.pinnedMessages)||void 0===o||null===(r=o.at(-1))||void 0===r?void 0:r.username}),Object(I.jsx)("p",{style:ke.pinMessageContentText,children:A?null===A||void 0===A?void 0:A.message:null===p||void 0===p||null===(a=p.pinnedMessages)||void 0===a||null===(s=a.at(-1))||void 0===s?void 0:s.message})]})]})]})]})]})})},re=function(e){var t=e.socket,n=e.room,o=e.setLastMsgRoomId,r=(e.rooms,e.setRooms,e.leave),a=Object(i.useState)([]),c=Object(l.a)(a,2),d=c[0],u=c[1],p=Object(i.useState)(n),j=Object(l.a)(p,2),f=j[0],m=j[1],h=Object(i.useState)(null),g=Object(l.a)(h,2),v=g[0],O=g[1],y=Object(i.useState)([]),w=Object(l.a)(y,2),C=w[0],k=w[1];return Object(i.useEffect)((function(){m(n),-1!==(null===n||void 0===n?void 0:n._id)&&b.a.get("/message/room/"+(null===n||void 0===n?void 0:n._id),{withCredentials:!0}).then((function(e){u(e.data.msg)}))}),[n]),Object(i.useEffect)((function(){return t.on("your_new_message",(function(e,t){o(t),o(""),t===(null===n||void 0===n?void 0:n._id)&&O(e)})),t.on("dialog-deleted",(function(e){var t=Object(s.a)(d);t.every((function(n,i){return n._id!==e||(t.splice(i,1),!1)})),u(Object(s.a)(t))})),function(){t.off("your_new_message"),t.off("dialog-deleted")}}),[d,t]),Object(i.useEffect)((function(){v&&u([].concat(Object(s.a)(d),[v]))}),[v]),Object(i.useEffect)((function(){return t.on("loggedIn",(function(e){k(Object(s.a)(e))})),t.on("loggedOut",(function(e){k(Object(s.a)(e))})),function(){t.off("loggedIn"),t.off("loggedOut")}}),[C,t]),Object(I.jsxs)("div",{children:[Object(I.jsx)(oe,{userOnlines:C,room:n,dialogs:d,leave:r,socket:t}),Object(I.jsxs)("div",{children:[Object(I.jsx)(N,{room:f,socket:t,dialogs:d,setDialogs:u,deleteMessage:function(e,i){var o=x.a.get("userId"),r=o.indexOf('"'),a=o.slice(r+1,o.length-1);if(e.from.userId===a||i===a){var c=Object(s.a)(d);c.every((function(t,n){return t._id!==e._id||(c.splice(n,1),!1)})),u(Object(s.a)(c)),t.emit("delete",e._id,n)}}}),Object(I.jsx)(S,{room:f,setDialogs:function(e,i){t.emit("chat",e,i,x.a.get("userId"),n._id)},socket:t})]})]})},ae=n(392),se=n(112),ce=n.n(se),le=n(122),de=n.n(le),ue=(n(331),function(){var e=Object(i.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],r={container:{position:"absolute",left:"10em",top:"-2.5em",display:Object(m.useMediaQuery)({maxWidth:1300})?"none":"block"},text:{fontSize:"30px",color:"cyan",fontWeight:"bold",transform:n?"translate(200px, 0)":"none",opacity:n?1:0,fontFamily:"Comfortaa",transition:"transform 1000ms ease-out, opacity 800ms"}};return Object(i.useEffect)((function(){setTimeout((function(){o(!0)}),2e3)}),[]),Object(I.jsxs)("div",{style:r.container,children:[Object(I.jsx)("p",{className:"intro-text",children:"Chatcord"}),Object(I.jsx)("p",{style:r.text,children:"...connect people around the world"})]})});n(332);te.a.configure({autoClose:2e3,draggable:!1,position:te.a.POSITION.BOTTOM_RIGHT});var pe=function(e){var t=e.logIn,n=e.invalid,o=(e.errorToggle,e.message,Object(i.useState)(!1)),r=Object(l.a)(o,2),a=r[0],s=r[1],d=Object(i.useState)({email:"",fullname:"",username:"",password:""}),p=Object(l.a)(d,2),j=p[0],f=p[1],x=Object(i.useState)(!1),h=Object(l.a)(x,2),O=h[0],y=h[1],w=Object(i.useState)({email:"",code:""}),C=Object(l.a)(w,2),k=C[0],S=C[1],R=Object(i.useState)("login"),D=Object(l.a)(R,2),F=D[0],M=D[1],z=Object(m.useMediaQuery)({maxWidth:1300}),E={textField:{display:"block",marginBottom:"20px"},div:{position:"relative",width:"100%",height:"100%",background:"linear-gradient(135deg, rgba(88,63,243,1) 0%, rgba(255,77,0,0.7962535355939251) 100%)"},button:{width:"100%",background:"#000000",color:"#ffffff",height:"3em",marginBottom:"1em"},loginForm:{width:"350px",overflow:"hidden",background:"#ffffff",padding:"50px 0px 30px 0px",borderRadius:"10px",height:"550px",maxWidth:"350px",transition:"max-width 200ms"},signupForm:{width:"350px",overflow:"hidden",background:"#ffffff",padding:"50px 0px 30px 0px",borderRadius:"10px",height:"650px",maxWidth:"350px",transition:"max-width 200ms"},header:{fontWeight:"bold",fontSize:"40px",marginBottom:"1.5em",fontFamily:"Roboto"},createAccount:{fontWeight:"bold",cursor:"pointer",color:O?"#555555":"#000000",transition:"color 300ms"},buttons:{display:"flex",flexDirection:"column",margin:"auto",width:"50%",paddingTop:"2em",marginBottom:"4em"},forms:{textAlign:"center",position:"absolute",right:z?0:"10em",left:z?0:"auto",margin:"auto",top:"5em",display:"flex",justifyContent:"center"},alertText:{color:"red",fontWeight:"bold"},alert:{color:"#ff0000",opacity:n?1:0,transition:"opacity 250ms"}},_=function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/auth/register",j).then((function(e){200===e.status?(te.a.success("".concat(e.data.msg)),M("verify")):s(!0)})).catch((function(e){te.a.error("".concat(e.response.data.msg))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/auth/verify",k).then((function(e){200===e.status&&(te.a.success("".concat(e.data.msg)),M("login"))})).catch((function(e){te.a.error("".concat(e.response.data.msg))}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{style:E.div,children:[Object(I.jsx)(ue,{}),Object(I.jsxs)("div",{style:E.forms,children:["login"===F&&Object(I.jsxs)("form",{autoComplete:"off",noValidate:!0,style:E.loginForm,children:[Object(I.jsx)("h1",{style:E.header,children:"LOGIN"}),Object(I.jsx)(g.a,{required:!0,value:j.email,id:"input-with-icon-textfield",style:E.textField,onChange:function(e){return f(Object(H.a)(Object(H.a)({},j),{},{email:e.target.value}))},placeholder:"email",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(ce.a,{})})}}),Object(I.jsx)(g.a,{required:!0,value:j.password,id:"standard-basic",style:E.textField,onChange:function(e){return f(Object(H.a)(Object(H.a)({},j),{},{password:e.target.value}))},onKeyUp:function(e){"Enter"===e.key&&t(j)},placeholder:"password",type:"password",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(de.a,{})})}}),Object(I.jsx)("h4",{style:E.alert,children:"Something went wrong"}),Object(I.jsx)("div",{style:E.buttons,children:Object(I.jsx)(ae.a,{style:E.button,variant:"contained",color:"primary",onClick:function(e){e.preventDefault(),t(j)},children:"Log in"})}),Object(I.jsx)("p",{style:E.createAccount,onMouseEnter:function(){return y(!0)},onMouseLeave:function(){return y(!1)},onClick:function(e){e.preventDefault(),f({email:"",password:""}),M("signup")},children:"Create account ?"})]}),"verify"===F&&Object(I.jsxs)("form",{autoComplete:"off",noValidate:!0,style:E.loginForm,children:[Object(I.jsx)("h1",{style:E.header,children:"Verify"}),Object(I.jsx)(g.a,{required:!0,value:k.email,id:"input-with-icon-textfield",style:E.textField,onChange:function(e){return S(Object(H.a)(Object(H.a)({},k),{},{email:e.target.value}))},placeholder:"email",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(ce.a,{})})}}),Object(I.jsx)(g.a,{required:!0,id:"standard-basic",style:E.textField,onChange:function(e){return S(Object(H.a)(Object(H.a)({},k),{},{code:e.target.value}))},placeholder:"verify code",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(de.a,{})})}}),a?Object(I.jsx)("h4",{style:E.alert,children:"Something went wrong"}):null,Object(I.jsx)("div",{style:E.buttons,children:Object(I.jsx)(ae.a,{style:E.button,variant:"contained",color:"primary",onClick:function(e){e.preventDefault(),B()},children:"Confirm"})})]}),"signup"===F&&Object(I.jsxs)("form",{autoComplete:"off",noValidate:!0,style:E.signupForm,children:[Object(I.jsx)("h1",{style:E.header,children:"Create account"}),Object(I.jsx)(g.a,{required:!0,value:j.email,id:"standard-basic",style:E.textField,onChange:function(e){return f((function(t){return Object(H.a)(Object(H.a)({},t),{},{email:e.target.value})}))},placeholder:"email",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(ce.a,{})})}}),Object(I.jsx)(g.a,{required:!0,value:j.fullname,id:"standard-basic",style:E.textField,onChange:function(e){return f((function(t){return Object(H.a)(Object(H.a)({},t),{},{fullname:e.target.value})}))},placeholder:"fullname",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(ce.a,{})})}}),Object(I.jsx)(g.a,{required:!0,value:j.username,id:"standard-basic",style:E.textField,onChange:function(e){return f((function(t){return Object(H.a)(Object(H.a)({},t),{},{username:e.target.value})}))},placeholder:"username",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(ce.a,{})})}}),Object(I.jsx)(g.a,{required:!0,value:j.password,id:"standard-basic",style:E.textField,type:"password",onChange:function(e){return f((function(t){return Object(H.a)(Object(H.a)({},t),{},{password:e.target.value})}))},placeholder:"password",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(de.a,{})})}}),Object(I.jsx)(g.a,{required:!0,error:a,id:a?"standard-error-helper-text":"standard-basic",style:E.textField,type:"password",onChange:function(e){s(e.target.value!==j.password)},onKeyUp:function(e){"Enter"===e.key&&_()},placeholder:"confirm password",InputProps:{startAdornment:Object(I.jsx)(v.a,{position:"start",children:Object(I.jsx)(de.a,{})})}}),Object(I.jsxs)("div",{style:E.buttons,children:[Object(I.jsx)(ae.a,{style:E.button,variant:"contained",color:"primary",onClick:function(e){e.preventDefault(),_(),S({email:j.email})},children:"Create Account"}),Object(I.jsx)(ae.a,{style:{background:"#ffffff",color:"#000000",border:"3px solid black"},variant:"contained",color:"primary",onClick:function(e){e.preventDefault(),M("login")},children:"Back"})]})]})]})]})},je=n(382),be=function(){var e={textAlign:"center",height:"100%",background:"linear-gradient(135deg, rgba(88,63,243,1) 0%, rgba(255,77,0,0.7962535355939251) 100%)",content:{position:"absolute",top:"40%",left:"45%"}};return Object(I.jsx)("div",{style:e,children:Object(I.jsxs)("div",{style:e.content,children:[Object(I.jsx)(je.a,{}),Object(I.jsx)("p",{children:"Wait a few second..."})]})})},fe=n(396),xe=n(383),me=n(388),he=Object(xe.a)((function(e){return{large:{width:e.spacing(10),height:e.spacing(10)}}})),ge=function(e){var t=e.user,n=e.logout,o=he(),r=Object(i.useState)(!1),a=Object(l.a)(r,2),s=a[0],d=a[1],p=Object(i.useState)(null),j=Object(l.a)(p,2),f=j[0],x=j[1],m=Object(i.useState)({fullname:"",username:"",avatar:"",password:""}),h=Object(l.a)(m,2),g=h[0],v=h[1],O=Object(i.useState)(),y=Object(l.a)(O,2),w=y[0],S=y[1],R=function(){d(!s)},D=function(){var e=Object(c.a)(u.a.mark((function e(){var n,i,o,r,a,s,c,l,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=g,!w){e.next=11;break}return i={contentType:w.type},o=C.ref("userAvatars/".concat(w.name)),e.next=6,o.put(w,i);case 6:return r=e.sent,e.next=9,r.ref.getDownloadURL();case 9:a=e.sent,n.avatar=a;case 11:return e.prev=11,console.log(g),e.next=15,b.a.put("/user/".concat(t._id),n,{withCredentials:!0});case 15:c=e.sent,te.a.success(null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.msg),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(11),te.a.error("".concat(null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l||null===(p=l.data)||void 0===p?void 0:p.msg));case 22:x(g.avatar),S(null),d(!1);case 25:case"end":return e.stop()}}),e,null,[[11,19]])})));return function(){return e.apply(this,arguments)}}(),F={userInformation:{display:"flex",alignItems:"center",alignContent:"flex-start",justifyContent:"flex-end",height:"100px",width:"100%",backgroundColor:"#E3F6FC",marginBottom:"10px"},avatar:{fontSize:"xx-large",marginRight:"20px",marginLeft:"20px",background:"#"+t.color,cursor:"pointer"},info:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"start"},fullname:{fontFamily:"Poppins",fontStyle:"normal",fontWeight:"600",fontSize:"20px",color:"#52585D",margin:"0px"},username:{fontStyle:"normal",fontFamily:"Poppins",padding:"5px 10px",backgroundColor:"#6588DE",borderRadius:"14px",color:"#FFFFFF",fontSize:"10px"},userAvaterEdit:{width:"fit-content",display:"block",margin:"auto",border:"4px solid #"+t.color,borderRadius:"115px",cursor:"pointer"}};return Object(I.jsxs)("div",{style:F.userInformation,children:[Object(I.jsx)(fe.a,{onClick:R,style:F.avatar,className:o.large,src:t.avatar}),Object(I.jsxs)(me.a,{visible:s,closable:!1,title:"Update User Info",onCancel:R,footer:null,children:[s&&Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{style:F.userAvaterEdit,htmlFor:"userAvatar",children:Object(I.jsx)(T.a,{size:200,src:f||t.avatar})}),Object(I.jsx)("input",{id:"userAvatar",style:{visibility:"hidden"},accept:"image/*",type:"file",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){x(n.result)},S(t)}})]}),Object(I.jsxs)($.a,{labelCol:{span:8},wrapperCol:{span:16},onFinish:D,children:[Object(I.jsx)($.a.Item,{label:"Full Name",rules:[{required:!0,message:"Please input your full name!"}],children:Object(I.jsx)(K.a,{defaultValue:t.fullname,onChange:function(e){return v(Object(H.a)(Object(H.a)({},g),{},{fullname:e.target.value}))}})}),Object(I.jsx)($.a.Item,{label:"Username",rules:[{required:!0,message:"Please input your username!"}],children:Object(I.jsx)(K.a,{defaultValue:t.username,onChange:function(e){return v(Object(H.a)(Object(H.a)({},g),{},{username:e.target.value}))}})}),Object(I.jsx)($.a.Item,{label:"Password",name:"password",rules:[{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,}$/,message:"Password must be at least 6 characters, contain at least one uppercase letter, one lowercase letter, one number and one special character!"}],children:Object(I.jsx)(K.a.Password,{onChange:function(e){return v(Object(H.a)(Object(H.a)({},g),{},{password:e.target.value}))}})}),Object(I.jsx)($.a.Item,{label:"Confirm Password",name:"confirm",rules:[{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,}$/,message:"Password must be at least 6 characters, contain at least one uppercase letter, one lowercase letter, one number and one special character!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(I.jsx)(K.a.Password,{})}),Object(I.jsx)($.a.Item,{wrapperCol:{offset:8,span:16},children:Object(I.jsx)(Z.a,{type:"primary",htmlType:"submit",children:"Save"})})]})]}),Object(I.jsxs)("div",{style:F.info,children:[Object(I.jsx)("p",{style:F.fullname,children:t.fullname}),Object(I.jsx)("p",{style:F.username,children:t.username})]}),Object(I.jsx)(k.a,{icon:"ion:log-out-outline",style:{fontSize:"30px",marginRight:"20px",marginLeft:"20px",cursor:"pointer"},onClick:n})]})},ve=Object(xe.a)((function(e){return{large:{width:e.spacing(10),height:e.spacing(10)},small:{width:e.spacing(6),height:e.spacing(6)}}})),Oe=function(e){var t=e.room,n=e.onClick,o=e.lastMsgRoomId,r=(e.setLastMsgRoomId,e.leaveHandle,e.roomManage,e.choosen),a=(ve(),Object(i.useState)(!1)),s=Object(l.a)(a,2),d=s[0],p=s[1],j=Object(i.useState)(!1),f=Object(l.a)(j,2),x=f[0],h=f[1],g=Object(i.useState)(""),v=Object(l.a)(g,2),O=v[0],y=v[1],w=Object(i.useState)(null),C=Object(l.a)(w,2),S=C[0],R=C[1],D=Object(i.useState)(!1),F=Object(l.a)(D,2),M=F[0],z=F[1],E=Object(m.useMediaQuery)({maxWidth:1300}),_={room_container:{position:"relative",marginTop:"18px"},room:{position:"relative",width:E?"12em":"90%",margin:"auto",background:r||x?"#6588DE":"#E3F6FC",padding:"10px",borderRadius:"14px",boxShadow:r||x?"0px 8px 40px rgba(0, 72, 251, 0.3)":"none",overflow:"hidden",marginBottom:10,maxHeight:d?E?"250px":"220px":"100px",transition:"max-height 250ms, border 250ms, background 250ms",height:"74px"},roomInfo:{margin:"0px",padding:"0px",display:"flex",cursor:"pointer",alignItems:"center",alignContent:"center",flexDirection:"row",gap:"10px"},avatar:{fontSize:"20px",flexShrink:0,background:"#"+(null===t||void 0===t?void 0:t.color)},roomMessage:{flexGrow:"1"},roomMessageName:{margin:"0px",padding:"0px",fontSize:"18px",fontWeight:"bold",color:r||x?"#FDFDFE":"#52585D",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",width:"150px",workBreak:"break-word"},roomMessageLastMessage:{margin:"0px",padding:"0px",fontSize:"12px",color:r||x?"#F2F6F7":"#96A9BA",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",width:"150px",workBreak:"break-word"},messageTime:{color:r||x?"#FDFDFE":"#96A9BA"},button:{position:"absolute",fontSize:"50px",color:"#5b5b5b",right:"0.5em",top:40,margin:"auto",transform:d?"rotate(90deg)":"none",transition:"transform 200ms"},roomOption:{background:"#c4c4c4",fontSize:"large",marginBottom:"0",marginTop:"0.1em",borderRadius:"5px",cursor:"pointer",paddingLeft:"1em"},private:{position:"absolute",fontSize:"30px",right:0,top:0,color:"#52585D"}};return Object(i.useEffect)(Object(c.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d&&!r&&p(!1),(null===t||void 0===t?void 0:t._id)!==o){e.next=8;break}return e.next=4,b.a.get("/room/".concat(o),{withCredentials:!0});case 4:n=e.sent,y(n.data.msg.lastMessage),R(n.data.msg.lastMessageDate),z(!0);case 8:case"end":return e.stop()}}),e)}))),[r,o]),Object(I.jsx)("div",{style:_.room_container,onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)},children:Object(I.jsx)("div",{style:_.room,children:Object(I.jsxs)("div",{style:_.roomInfo,onClick:function(){return n(t)},children:[Object(I.jsx)(T.a,{size:56,style:_.avatar,src:t.avatar}),Object(I.jsxs)("div",{style:_.roomMessage,children:[Object(I.jsx)("p",{style:_.roomMessageName,children:null===t||void 0===t?void 0:t.name}),Object(I.jsx)("p",{style:_.roomMessageLastMessage,children:M?O:null===t||void 0===t?void 0:t.lastMessage})]}),Object(I.jsx)("span",{style:_.messageTime,children:A()("".concat(M?S:null===t||void 0===t?void 0:t.lastMessageDate)).fromNow()}),t.isPrivate&&Object(I.jsx)(k.a,{style:_.private,icon:"ri:chat-private-line"})]})})})},ye=function(e){var t=e.rooms,n=(e.joinRoom,e.leaveRoom),i=e.switchRoom,o=e.roomManage,r=e.currentRoom,a=e.lastMsgRoomId,s=e.setLastMsgRoomId;return Object(I.jsx)("div",{style:{overflow:"auto",width:"100%",height:"77%",backgroundColor:"#E3F6FC"},children:null===t||void 0===t?void 0:t.map((function(e){return Object(I.jsx)(Oe,{choosen:(null===r||void 0===r?void 0:r._id)===(null===e||void 0===e?void 0:e._id),room:e,lastMsgRoomId:a,setLastMsgRoomId:s,leaveHandle:n,onClick:i,roomManage:o},null===e||void 0===e?void 0:e._id)}))})},we=function(e){var t=e.joinRoom,n=e.findRoom,o=e.handleSearchRoom,r=Object(i.useState)(!1),a=Object(l.a)(r,2),s=a[0],c=a[1],d=Object(i.useState)(!1),u=Object(l.a)(d,2),p=u[0],j=u[1],b=Object(i.useState)(!1),f=Object(l.a)(b,2),x=f[0],m=(f[1],Object(i.useState)({name:"",description:"",isPrivate:!1})),h=Object(l.a)(m,2),g=h[0],v=h[1],O=Object(i.useState)(""),y=Object(l.a)(O,2),w=y[0],C=y[1],S={roomHeaderContainer:{display:"flex",justifyContent:"space-around",alignItems:"center",backgroundColor:"#E3F6FC",height:"10%",padding:"10px",width:"100%"},input:{width:"100%",outline:"none",fontSize:"1.2rem",borderRadius:"8px",height:"40px",backgroundColor:"#FDFDFD",border:"1px solid #6588DE",boxSizing:"border-box",margin:"5px",marginLeft:"15px"},add:{color:"#6588DE",fontSize:"60px",margin:"2.5px 5px",cursor:"pointer"},join:{color:"#6588DE",fontSize:"60px",margin:"2.5px 5px",cursor:"pointer"},addUser:{color:"#6588DE",fontSize:"60px",margin:"2.5px 5px",cursor:"pointer"}},R=function(){c(!1)},D=function(){j(!1)};return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{style:S.roomHeaderContainer,children:[Object(I.jsx)(k.a,{style:S.add,icon:"akar-icons:search",onClick:o}),Object(I.jsx)(k.a,{style:S.add,icon:"akar-icons:chat-add",onClick:function(){c(!0)}}),Object(I.jsx)(k.a,{style:S.join,icon:"fluent:chat-arrow-back-16-regular",onClick:function(){j(!0)}})]}),Object(I.jsx)(me.a,{title:"Create room",closable:!1,visible:s,footer:[Object(I.jsx)(Z.a,{onClick:R,children:"Cancel"}),Object(I.jsx)(Z.a,{type:"primary",onClick:function(){t(g),R()},children:"Create"},"submit")],children:Object(I.jsxs)($.a,{name:"control-hooks",children:[Object(I.jsx)($.a.Item,{label:"Room name",name:"roomName",rules:[{required:!0}],onChange:function(e){return v((function(t){return Object(H.a)(Object(H.a)({},t),{},{name:e.target.value})}))},children:Object(I.jsx)(K.a,{})}),Object(I.jsx)($.a.Item,{label:"Description",name:"description",rules:[{required:!0}],onChange:function(e){return v((function(t){return Object(H.a)(Object(H.a)({},t),{},{description:e.target.value})}))},children:Object(I.jsx)(K.a,{})}),Object(I.jsx)(Y.a,{checkedChildren:"Private",unCheckedChildren:"Public",onChange:function(e){return v((function(e){return Object(H.a)(Object(H.a)({},e),{},{isPrivate:!x})}))}})]})}),Object(I.jsx)(me.a,{title:"Join room",closable:!1,visible:p,footer:[Object(I.jsx)(Z.a,{onClick:D,children:"Cancel"}),Object(I.jsx)(Z.a,{type:"primary",onClick:function(){n(w),D()},children:"Join"},"submit")],children:Object(I.jsx)($.a,{name:"control-hooks",children:Object(I.jsx)($.a.Item,{label:"Room ID",name:"roomShortId",rules:[{required:!0}],onChange:function(e){return C(e.target.value)},children:Object(I.jsx)(K.a,{})})})})]})},Ce=function(){return Object(I.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"95%",fontSize:"1.5em",backgroundColor:"rgb(227, 246, 252)",margin:"auto 20px",borderRadius:"14px"},children:Object(I.jsxs)("h1",{children:["pick a room to start ",Object(I.jsx)("br",{})," or create a new room"]})})},ke=function(e){var t=e.rooms,n=e.joinRoom,o=e.leaveRoom,r=e.switchRoom,a=e.roomManage,s=e.currentRoom,c=e.handleSearchRoom,d=Object(i.useState)([]),u=Object(l.a)(d,2),p=u[0],j=u[1],b={inputSection:{display:"flex",justifyContent:"space-between",alignItems:"center"},input:{width:"100%",height:"40px",borderRadius:"10px",borderColor:"#6588DE"},searchRoom:{width:"100%",height:"102%",overflowY:"hidden"},add:{color:"#6588DE",fontSize:"60px",margin:"2.5px 5px",cursor:"pointer"}};return Object(I.jsxs)("div",{style:b.searchRoom,children:[Object(I.jsxs)("div",{style:b.inputSection,children:[Object(I.jsx)(k.a,{style:b.add,icon:"bx:bx-arrow-back",onClick:function(){return c()}}),Object(I.jsx)("input",{style:b.input,placeholder:"search room",onChange:function(e){var n=e.target.value;j(t.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())})))}})]}),Object(I.jsx)(ye,{currentRoom:s,rooms:p,joinRoom:n,leaveRoom:o,switchRoom:r,roomManage:a,handleSearchRoom:c})]})};b.a.defaults.baseURL="https://chat-cord-api.herokuapp.com";var Ie=p.a.connect("/");var Se=function(){var e=Object(i.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],r=Object(i.useState)(!1),a=Object(l.a)(r,2),d=a[0],p=a[1],j=Object(i.useState)(!1),f=Object(l.a)(j,2),h=f[0],g=f[1],v=Object(i.useState)(null),O=Object(l.a)(v,2),y=O[0],w=O[1],C=Object(i.useState)(""),k=Object(l.a)(C,2),S=(k[0],k[1],Object(i.useState)(!1)),R=Object(l.a)(S,2),D=(R[0],R[1]),F=Object(i.useState)({_id:-1,name:" ",color:""}),M=Object(l.a)(F,2),z=M[0],E=M[1],_=Object(i.useState)(""),B=Object(l.a)(_,2),L=B[0],P=B[1],A=Object(i.useState)([]),T=Object(l.a)(A,2),W=T[0],U=T[1],N=Object(i.useState)(!1),q=Object(l.a)(N,2),H=q[0],V=q[1],G=Object(i.useState)(""),K=Object(l.a)(G,2),Q=K[0],J=(K[1],Object(i.useState)(!1)),$=Object(l.a)(J,2),Y=$[0],Z=$[1],X={left:{width:Object(m.useMediaQuery)({maxWidth:1300})?"15em":"25%",float:"left",boxSizing:"border-box"},right:{width:"100%",height:"100%",float:"right",position:"relative",flexGrow:1},userInformation:{display:"flex",alignItems:"center",borderBottom:"2px solid #4a336e",padding:"20px",fontSize:"large",marginBottom:"10px"}},ee=function(){var e=Object(c.a)(u.a.mark((function e(t){var n,i,o,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,e.next=4,b.a.post("/auth/login",t,{withCredentials:!0});case 4:i=e.sent,te.a.success("Logged in successfully"),g(void 0!==i.data.user._id),p(void 0===i.data.user._id),w(i.data.user),n=i.data.user._id,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),te.a.error("".concat(null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.msg));case 15:return e.next=17,b.a.get("/room/retrieve",{withCredentials:!0});case 17:return a=e.sent,U(a.data.msg),0!==a.data.length&&E(a.data[0]),e.next=22,Ie.emit("login",n);case 22:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(c.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.a.post("/room/"+t+"/leave",{withCredentials:!0}).then((function(e){var n=W.findIndex((function(e){return e._id===t}));if(-1!==n){W.splice(n,1);var i=Object(s.a)(W);i.every((function(e,n){return e._id!==t||(i.splice(n,1),!1)})),E({_id:-1,name:" ",color:""})}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(c.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==W.findIndex((function(e){return e.shortId===t}))){e.next=6;break}return e.next=4,b.a.post("/room/"+t+"/attend",{withCredentials:!0});case 4:200===(n=e.sent).status?(U([n.data.msg].concat(Object(s.a)(W))),E(n.data.msg)):400===n.status?E(n.data.msg):te.a.error("".concat(n.data.msg));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(c.a)(u.a.mark((function e(t){var n,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return e.prev=1,e.next=4,b.a.post("/room/create",t,{withCredentials:!0});case 4:n=e.sent,U([n.data.msg].concat(Object(s.a)(W))),E(n.data.msg),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),te.a.error("".concat(null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.msg));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(e){(null===e||void 0===e?void 0:e._id)!==(null===z||void 0===z?void 0:z._id)&&(Ie.emit("leaveRoom",null===z||void 0===z?void 0:z._id,null===e||void 0===e?void 0:e._id),E(e)),E(e),Z(!1)},se=function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x.a.get("userId"),n=t.indexOf('"'),i=t.slice(n+1,t.length-1),e.next=5,Ie.emit("logout",i);case 5:x.a.remove("userId"),window.location.reload();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(e){D(!0)};return Object(i.useEffect)((function(){var e=x.a.get("userId");if(V(void 0!==e),void 0!==e&&!h){b.a.get("/user/find",{withCredentials:!0}).then((function(e){w(e.data.msg)})),b.a.get("/room/retrieve",{withCredentials:!0}).then((function(e){U(e.data.msg),0!==e.data.length&&E(e.data.msg[0])})),g(!0);var t=e.indexOf('"'),n=e.slice(t+1,e.length-1);Ie.emit("login",n)}Ie.once("connected",(function(){return o(!0)}))}),[y,W,h]),Object(i.useEffect)((function(){z&&Ie.emit("joinRoom",z)}),[z]),Object(i.useEffect)((function(){try{b.a.get("/room/".concat(L),{withCredentials:!0}).then((function(e){(null===z||void 0===z?void 0:z._id)!==L&&(U([e.data.msg].concat(Object(s.a)(W.filter((function(t){return t._id!==e.data.msg._id}))))),E(z))}))}catch(e){console.log(e)}}),[L]),Object(I.jsx)("div",{className:"App",children:n?(h||H)&&y?Object(I.jsx)("div",{style:{position:"relative",width:"100%",height:"100%"},children:Object(I.jsxs)("div",{style:{height:"100%",display:"flex"},children:[Object(I.jsxs)("div",{style:X.left,children:[Object(I.jsx)(ge,{user:y,logout:se}),Y&&Object(I.jsx)(ke,{currentRoom:z,rooms:W,joinRoom:oe,leaveRoom:ne,switchRoom:ae,roomManage:ce,handleSearchRoom:Z}),!Y&&Object(I.jsx)(we,{joinRoom:oe,findRoom:ie,handleSearchRoom:Z}),!Y&&Object(I.jsx)(ye,{currentRoom:z,rooms:W,joinRoom:oe,lastMsgRoomId:L,setLastMsgRoomId:P,leaveRoom:ne,switchRoom:ae,roomManage:ce})]}),z?Object(I.jsx)("div",{style:X.right,children:Object(I.jsx)(re,{socket:Ie,room:z,rooms:W,setRooms:U,setLastMsgRoomId:P,leave:ne})}):Object(I.jsx)(Ce,{})]})}):Object(I.jsx)(pe,{message:Q,logIn:ee,invalid:d,errorToggle:p}):Object(I.jsx)(be,{})})};a.a.render(Object(I.jsx)(o.a.StrictMode,{children:Object(I.jsx)(Se,{})}),document.getElementById("root"))}},[[334,1,2]]]);
//# sourceMappingURL=main.f0d1c0c3.chunk.js.map